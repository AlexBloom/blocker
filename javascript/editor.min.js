var app;init();function init(){var b=["javascript/libraries/jquery-1.7.1.min.js","javascript/libraries/jquery-ui-1.8.17.custom.min.js","javascript/libraries/jquery.mousewheel.js","javascript/libraries/jquery.event.drag-2.0.js","javascript/libraries/date.format.js"];yepnope({load:b,complete:a});function a(d,c,e){app=new Application();app.init()}}function Application(){var a=this;var g;function f(){g=new Editor();g.init();g.start();$(document).keydown(b);d();window.addEventListener("online",e);window.addEventListener("offline",c);if(!navigator.onLine){$(".toggle-button").hide()}}function b(h){var i=h.which;g.keyDown(h,i)}function d(){if(Modernizr.touch){var h="";h+='<article class="browser-warning">';h+="<strong>Not Optimized for Touch Input</strong>";h+=" You are using a touch enabled device. Please be aware that this application is not yet optimized for touch input";h+="</div>";$("body").prepend(h)}}function c(h){$(".toggle-button").fadeOut()}function e(h){$(".toggle-button").fadeIn()}a.init=f}function Editor(){var f=this;var c={};c.history=new History();c.memory=new Memory();c.navigation=new Navigation();c.canvas=new Canvas();c.help=new Help();var h=false;function i(){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder;window.URL=window.webkitURL||window.URL;d("init",c)}function a(){if(!h){h=true;d("start");$(".show-gallery").addClass("active");$(".help-button").addClass("help-button-active")}}function g(){if(h){h=false;d("stop");$(".help-button").removeClass("help-button-active")}}function d(k,j){for(name in c){if(c[name][k]){c[name][k](j)}}}f.init=i;f.start=a;f.stop=g;f.keyDown=e;f.getBlockSize=c.canvas.getBlockSize;function e(j,k){if(getNumberKey(k)!==-1){if(!$("input:focus").length){b(j,k)}}else{if(!$("input:focus").length){if(k===8){if(c.canvas.getMode()==="delete"){j.preventDefault();c.canvas.deleteSelected();c.navigation.showInfo(c.canvas.getMode())}}if(j.metaKey||j.ctrlKey){if(k===90||k===122){if(j.shiftKey){j.preventDefault();c.canvas.historyUpdate("redo")}else{j.preventDefault();c.canvas.historyUpdate("undo")}c.navigation.showInfo(c.canvas.getMode())}if(k===111||k===79){j.preventDefault();c.navigation.showInfo("import")}if(k===69||k===101){j.preventDefault();c.navigation.showInfo("export")}if(k===83||k===115){j.preventDefault();c.navigation.showInfo("save")}if(k===65){j.preventDefault();c.canvas.setMode("single");c.navigation.showInfo("single")}if(k===77||k===109){j.preventDefault();c.canvas.setMode("multiple");c.navigation.showInfo("multiple")}if(k===68||k===100){j.preventDefault();c.canvas.setMode("delete");c.navigation.showInfo("delete")}if(k===72){if($("#blocks").hasClass("blocks-active")){j.preventDefault();c.help.toggle()}}}}if(k===13){if($(".export-info").hasClass("info-container-active")){if(!$(".export-info .download-link").length){$(".export-info #export-json").trigger("click")}else{}}if($(".import-info").hasClass("info-container-active")){$(".import-info #import-file").trigger("click")}if($(".save-info").hasClass("info-container-active")){$(".save-info .info-button").trigger("click")}}}}function b(k,l){if(h){k.preventDefault();var j=getNumberKey(l);var m=$(".color-buttons a").eq(j);var n=m.attr("id").replace("color-button-","");$(".color-buttons .active").removeClass("active");m.closest("li").addClass("active");if(c.canvas.getMode()==="delete"){c.canvas.setMode("single");c.navigation.showInfo("single")}else{c.navigation.showInfo(c.canvas.getMode())}c.canvas.colorUpdate(n)}}}function History(){var k=this;var h=[];var e=-1;var c=[];var b={};function p(q){b=q;l()}function j(q){if(e!==h.length&&h.length){h=h.slice(0,e)}h.push({action:q.action,blocks:q.blocks});e=h.length}function m(){var q=false;if(n()){var r=parseInt(e-1);q=h[r];q.history_action="undo";e--}return q}function i(){var q=false;if(a()){var r=e;q=h[r];q.history_action="redo";e++}return q}function a(){var q=false;if(e<h.length){q=true}return q}function n(){var q=false;if(e>0){q=true}return q}function d(){return h}function l(){var q=b.memory.load();if(q&&q.history){o(q.history)}}function o(q){c=q}function g(t,u){for(var s=0;s<c.length;s++){var q=[];if(c[s].blocks){for(var r=0;r<c[s].blocks.length;r++){if(c[s].blocks[r].index===t){c[s].blocks[r].index=u}q.push(c[s].blocks[r])}}if(c[s].block){if(c[s].block.index===t){c[s].block.index=u}q.push(c[s].block)}j({action:"add",blocks:q})}c=[]}function f(){h=[];e=-1}k.init=p;k.save=j;k.undo=m;k.redo=i;k.clear=f;k.hasNext=a;k.hasPrev=n;k.getHistory=d;k.importHistory=o;k.historyUpdateIDs=g}function Canvas(){var n=this;var f=false;var aa={};var l=getBlockSize();var p=[];var t={x:0,y:0,target:{x:0,y:0}};var o;var b=getColors();var H=b[0];var b;var j={width:1,depth:1};var c=true;var k=false;var Z={};function W(ab){aa=ab;$("body").click(B).mousemove(s).bind("dragstart",K).bind("drag",V).bind("dragend",I).append('<div id="cursor"></div>').append('<div id="blocks"></div>');y();J()}function C(){if(!f){f=true;$("#blocks").addClass("blocks-active");if(!o){o="single";aa.navigation.showInfo("single");$("#cursor").show();if(!$(".block.preview").length){y()}}}}function u(){if(f){f=false;$("#blocks").removeClass("blocks-active");$("#cursor").hide()}}function P(){E({blocks:$(".block")})}function B(ab){if(f){if(!$(ab.target).is("nav")&&!$(ab.target).closest("nav").length&&!$(ab.target).is(".help")&&!$(ab.target).closest(".help").length&&!$(ab.target).is(".gallery-toggle")&&!$(ab.target).closest(".gallery-toggle").length){if(c&&(o==="single"||o==="multiple")){i();L();y();J()}if(o==="delete"){O(ab)}}}}function s(ab){if(f){if(ab.pageY<$(window).height()-$("nav").height()){t.target.x=M(ab.pageX,ab.pageY).x;t.target.y=M(ab.pageX,ab.pageY).y;c=true;m();J();if(o==="single"||o==="multiple"){$("#cursor").show();if(!$(".block.preview").length){y()}$("#blocks").removeClass("no-preview")}else{$("#cursor").hide();if($(".block.preview").length){E($(".block.preview"))}$("#blocks").addClass("no-preview")}}else{c=false;$("#cursor").hide();if($(".block.preview").length){A()}$("#blocks").addClass("no-preview")}if(ab.shiftKey){k=true;if(o==="single"&&c&&$(".block.preview").length){i()}}else{shift_pressed=false}}}function K(ab,ad){if(f){Z={};if(k&&o==="delete"){$("body").append('<div id="selection"></div>');var ac={width:ad.deltaX,height:ad.deltaY,left:ad.startX,top:ad.startY};if(ad.deltaX<0){ac.width=ad.deltaX;ac.left=ad.startX+ad.deltaX}if(ad.deltaY<0){ac.height=ad.deltaY;ac.top=ad.startY+ad.deltaY}$("#selection").css(ac)}}if(ab){k=ab.shiftKey}}function V(ac,ag){if(f){k=ac.shiftKey;if(o==="single"&&c){if(!$(".block.preview").length){y()}var af=$("#cursor").position();if(Z.top!==af.top&&Z.left!==af.left){i();Z=af}}if(k&&o==="delete"){var ae={width:ag.deltaX,height:ag.deltaY,left:ag.startX,top:ag.startY};if(ag.deltaX<0){ae.width=ag.deltaX*-1;ae.left=ag.startX+ag.deltaX}if(ag.deltaY<0){ae.height=ag.deltaY*-1;ae.top=ag.startY+ag.deltaY}var ad=p.length;while(ad--){var ah=$("#block-"+p[ad].index);if(ah.length){var ab=ah.position();if(ab.left>=ae.left&&ab.left+l.width<=ae.left+ae.width&&ab.top>=ae.top&&ab.top+l.height<=ae.top+ae.height){ah.addClass("selected")}else{ah.removeClass("selected")}}}$("#selection").css(ae)}}}function I(ab){if(f){if(o==="delete"){$("#selection").remove()}k=false}}function m(){if(f){if(t.x!=t.target.x||t.y!=t.target.y){t.x+=parseInt(t.target.x-t.x);t.y+=parseInt(t.target.y-t.y)}var ab={top:t.y+(l.height/2),left:t.x-(l.height/2)};$("#cursor").css(ab)}}function L(ab){function af(ak,aj){var ai=(ak.position.x+(ak.position.y*p.length)+(ak.position.z*p.length*p.length));var ah=(aj.position.x+(aj.position.y*p.length)+(aj.position.z*p.length*p.length));var ag=ai-ah;return ag}var ae=ab||p;ae.sort(af);var ac=p.length;while(ac--){var ad=ae[ac];ad.z_index=ac+ad.position.z;$("#block-"+ad.index).css({zIndex:ac})}}function U(ab){if(f){var ad=ab||"solid";var ae={index:parseInt(S()+1),color:H,position:{x:t.x,y:t.y,z:T(t.x,t.y)},type:ab};var ac='<div class="block color-'+ae.color+'" id="block-'+ae.index+'"></div>';var af={top:ae.position.y+(-l.height*ae.position.z),left:ae.position.x};p.push(ae);$("#blocks").append(ac);$("#block-"+ae.index).css(af).hover(X,D);if(ab==="preview"){$("#block-"+ae.index).addClass("preview")}z()}}function E(ab){if(f){if(ab){if(ab.index){var ad=[];var ac=p.length;while(ac--){if(p[ac].index===ab.index){if(p[ac].type!=="preview"){ad.push(p[ac])}p.splice(ac,1);$("#block-"+p[ac].index).remove();break}}if(ad.length){aa.history.save({action:"remove",blocks:ad})}}if(ab.blocks){$(ab.blocks).each(function(){var ag=[];var af=R($(this));var ae=p.length;while(ae--){if(p[ae].index==af){if(p[ae].type!=="preview"){ag.push(p[ae])}$("#block-"+af).remove();p.splice(ae,1);break}}if(ag.length){aa.history.save({action:"remove",blocks:ag})}})}if(ab.position){var ad=[];var ac=p.length;while(ac--){if(p[ac].position.x===ab.position.x&&p[ac].position.y===ab.position.y&&p[ac].position.z===ab.position.z){if(p[ac].type!=="preview"){ad.push(p[ac])}$("#block-"+p[ac].index).remove();p.splice(ac,1);break}}if(ad.length){aa.history.save({action:"remove",blocks:ad})}}}z()}}function e(){E({blocks:$(".selected")})}function O(ab){if(f){var ac=$(ab.target);if(ac.hasClass("block")){ac.toggleClass("selected")}}}function X(ab){}function D(ab){}function J(){if(f){if(o==="single"){a()}if(o==="multiple"){q()}L()}}function A(){E({blocks:$(".block.preview")})}function d(){E({blocks:$(".block")})}function h(){E({blocks:$(".block.color-transparent")})}function a(){var ab={x:t.x,y:t.y,z:T(t.x,t.y)};var ae=R($(".block.preview"));var ad=p.length;while(ad--){if(p[ad].index===ae){p[ad].position=ab;break}}var ac={top:ab.y+(-l.height*ab.z),left:ab.x};$(".block.preview").css(ac)}function q(){if(f){$(".block.preview").each(function(ab,ad){var ac={x:ab%j.depth,y:Math.floor(ab/j.depth)};var ae={x:t.x,y:t.y,z:1};var ah=R($(ad));if(ac.x>0){ae.x+=l.height*ac.x;ae.y+=l.height*ac.x/2}if(ac.y>0){ae.x+=l.height*ac.y;ae.y-=l.height*ac.y/2}ae.z=T(ae.x,ae.y);var ag=p.length;while(ag--){if(p[ag].index===ah){p[ag].position=ae;break}}var af={top:ae.y+(-l.height*ae.z),left:ae.x};$(ad).css(af)})}}function y(){if(f){if(o==="single"){if($(".block.preview").length>1){E({blocks:$(".block.preview").not(":first")})}if(!$(".block.preview").length){U("preview")}}if(o==="multiple"){if($(".block.preview").length<j.width*j.depth){var ac=j.width*j.depth-$(".block.preview").length;for(var ad=0;ad<ac;ad++){U("preview")}}if($(".block.preview").length>(j.width*j.depth)){var ab=($(".block.preview").length-(j.width*j.depth))-1;E({blocks:$(".block.preview:gt("+ab+")")})}}z()}}function i(){if(f){var ab=[];$(".block.preview").each(function(){var ad=R($(this));$(this).removeClass("preview");var ac=p.length;while(ac--){if(p[ac].index===ad){ab.push(p[ac]);p[ac].type="solid";break}}});if(ab.length){aa.history.save({action:"add",blocks:ab})}z()}}function Y(ac,ab){if(f){$(".block.preview").addClass("color-"+ac).removeClass("color-"+ab)}}function x(ac,ab){options=aa.history[ac](ab);if(f){if(options&&options.blocks&&options.action&&options.history_action){if(options.history_action==="undo"){if(options.action==="add"){g(options)}if(options.action==="remove"){r(options)}}if(options.history_action==="redo"){if(options.action==="remove"){g(options)}if(options.action==="add"){r(options)}}}else{}}}function r(ab){if(f){var af=ab.blocks;var ad=af.length;while(ad--){var ae=af[ad];ae.index=parseInt(S()+1);var ac='<div class="block color-'+ae.color+'" id="block-'+ae.index+'"></div>';var ag={top:ae.position.y+(-l.height*ae.position.z),left:ae.position.x};p.push(ae);$("#blocks").append(ac);$("#block-"+ae.index).css(ag);L();z()}}}function g(ab){if(f){var af=ab.blocks;var ad=af.length;while(ad--){var ae=af[ad];var ac=p.length;while(ac--){if(p[ac].index===ae.index){$("#block-"+ae.index).remove();p.splice(ac,1);L();break}}}}}function M(ae,ad){var ac=(Math.round((ae-l.width)/l.height)*l.height)-l.height;var ab=(Math.round((ad-l.height)/l.height)*l.height);if((ac/l.height)%2==0){ab+=(l.height/2)}return{x:ac,y:ab}}function T(ai,af,ad){var ah=ad||p;var ac=0;var ab=false;var ae=p.length;while(ae--){var ag=ah[ae];if(ag.position.x===ai&&ag.position.y===af&&ag.type==="solid"&&ag.position.z>=ac){ac=ag.position.z;ab=true}}if(ab){ac++}return ac}function R(ac){var ab=false;if(ac.attr("id")){ab=parseInt(ac.attr("id").replace("block-",""))}return ab}function S(){var ab=0;var ac=p.length;while(ac--){if(p[ac].index>ab){ab=p[ac].index}}return ab}function Q(ab){if(f){o=ab;y();J();if(o==="delete"){A()}else{$(".block.selected").removeClass("selected")}}}function N(){return o}function v(ac,ab){if(f){Y(ac,ab);H=ac;J()}}function F(ab){if(f){j[ab.id]=ab.value;y();J()}}function w(ab){if(f){for(var ad=0;ad<ab.length;ad++){var af=ab[ad].index;var ae=ab[ad];ae.index=S()+1;var ac='<div class="block color-'+ae.color+'" id="block-'+ae.index+'"></div>';var ag={top:ae.position.y+(-l.height*ae.position.z),left:ae.position.x};aa.history.historyUpdateIDs(af,ae.index);p.push(ae);$("#blocks").append(ac);$("#block-"+ae.index).css(ag).hover(X,D)}z()}}function z(){if(f){$(".stats .count span").text($(".block:not(.preview)").length);if(!b){b=getColors()}var ac=b.length;while(ac--){var ab=$(".block.color-"+b[ac]+":not(.preview)").length;if(ab){if(!$(".stats .count-color-"+b[ac]).length){$(".stats").prepend('<p class="count-color count-color-'+b[ac]+'"><span></span> '+b[ac]+" blocks</p>")}$(".stats .count-color-"+b[ac]+" span").text(ab)}}}}function G(){E({blocks:$(".block.preview"),position:{x:0,y:0,z:0}});return p}n.init=W;n.start=C;n.stop=u;n.clear=P;n.setMode=Q;n.getMode=N;n.colorUpdate=v;n.sizeUpdate=F;n.historyUpdate=x;n.deleteSelected=e;n.getBlocks=G;n.importBlocks=w;n.getBlocks=G;n.previewRemove=A;n.previewUpdateBlocks=y;n.allRemove=d;n.deleteTransparent=h}function Help(){var g=this;var c;var j;function i(k){c=$(".help");j=$(".help-toggle");j.click(f);$("div > h1",c).click(a);$(window).resize(d);d()}function b(){c.addClass("active")}function h(){c.removeClass("active")}function e(){if(c.hasClass("active")){h()}else{b()}}function f(k){k.preventDefault();c.toggleClass("active")}function a(k){var l=$(k.target);l.closest("div").toggleClass("help-item-active")}function d(l){var k=$(window).height()-$("nav").height()-225;c.find(".help-text").css({"max-height":k})}g.init=i;g.start=b;g.stop=h;g.toggle=e}function Memory(){var g=this;var b={};function k(l){b=l}function f(n){var q=n.target.files;var m=[];for(var p=0;p<q.length;p++){var o={name:q[p].name,type:q[p].type,size:q[p].size};m.push(o)}if(m.length&&window.FileReader){var l=new FileReader();l.readAsText(q[0]);l.onload=(function(r){return function(s){a(s.target.result)}})(q[0])}}function a(n){b.canvas.clear();b.history.clear();var m={};try{m=jQuery.parseJSON(n)}catch(l){}if(m&&m.blocks&&m.history){b.canvas.clear();b.history.clear();b.history.importHistory(m.history);b.canvas.importBlocks(m.blocks)}}function j(n){if($("#blocks").length){var l=document.styleSheets[1];var q=$("#blocks").html();var p="";var m=new Date();var r={id:stringToSlug($("#export-sketch").val()),date:m.format("yyyy-mm-dd HH:MM"),name:$("#export-sketch").val()};for(var o=0;o<l.cssRules.length;o++){p+=l.cssRules[o].cssText+"\n"}q="<style>"+p+'</style><div id="blocks">'+q+"</div>";d(n,q,r,"text/html",".html")}}function c(m){if($("#blocks").length){var l=new Date();var o={blocks:b.canvas.getBlocks(),history:b.history.getHistory(),id:stringToSlug($("#export-sketch").val()),date:l.format("yyyy-mm-dd HH:MM"),name:$("#export-sketch").val()};var n="";if(JSON&&JSON.stringify){n=JSON.stringify(o)}d(m,n,o,"application/json",".json")}}function e(){if($("#blocks").length){var m=new Date;var n={blocks:b.canvas.getBlocks(),history:b.history.getHistory(),id:stringToSlug($("#save-sketch").val()),date:m.format("yyyy-mm-dd HH:MM"),name:$("#save-sketch").val()};var l=h()||[];l.push(n);if(Modernizr.localstorage&&JSON&&JSON.stringify){localStorage.setItem("blocks_data",JSON.stringify(l))}}b.navigation.savedToLocal()}function h(){var l=[];if(Modernizr.localstorage){l=jQuery.parseJSON(localStorage.getItem("blocks_data"))}return l}function d(l,r,p,q,s){if(window.BlobBuilder){$(".export-info input, .export-info label, .export-info .info-button").hide();if(!$(".export-info .download-link").length){$(".export-info h1").after('<a class="download-link info-button">Download File</a>')}var u=new BlobBuilder();u.append(r);var m=p.id||"myBlocks";m+=s;var t=window.URL.createObjectURL(u.getBlob(q));var o=$(".export-info .download-link");var n={download:m,href:t,"data-downloadurl":[q,m,t].join(":")};o.attr(n).click(i)}}function i(l){var m=$(l.target);var n=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;if(!n){l.preventDefault();l.stopPropagation();window.open(m.attr("href"))}m.remove();$(".export-info input, .export-info label, .export-info a").show()}g.exportHTML=j;g.exportJSON=c;g.fileImported=f;g.load=h;g.save=e;g.init=k}var Navigation=function(){var e=this;var r={min:1,max:20,value:1,step:1,slide:w};var h=false;var l={};function z(H){l=H;$(".color-buttons li:first").addClass("active");$(".mode-buttons a:first").addClass("active");u(".multiple-info .size-slider");$(".single-info").show();$(".color-buttons a").click(d);$(".mode-buttons a").click(x);$(".history-buttons a").click(B);$("#file-export").click(a);$("#file-import").click(o);$("#file-save").click(i);$("#file-load").click(s);$("#delete-selected").click(E);$("#delete-all").click(A);$("#delete-transparent").click(p);$(".save-info a").click(D);$("#export-html").click(f);$("#export-json").click(c);$("#import-file").change(m);$("nav").hover(b,G);var I=$(".color-buttons li.active a").attr("id").replace("color-button-","");if(!Modernizr.localstorage){$("#file-save, #file-load").remove()}if(!window.FileReader){$("#file-import").remove()}if(!window.BlobBuilder||!window.URL){$("#file-export").remove()}l.canvas.setMode("single");l.canvas.colorUpdate(I)}function v(){$("nav").hide()}function g(){$("nav").show()}function d(H){H.preventDefault();var I=l.canvas.getMode();var J=$(H.target).attr("id").replace("color-button-","");$(".color-buttons .active").removeClass("active");$(".color-buttons #color-button-"+J).closest("li").addClass("active");if(I==="delete"){l.canvas.setMode("single");n("single")}else{n(I)}l.canvas.colorUpdate(J)}function x(I){I.preventDefault();var H=$(I.target).attr("id").replace("mode-","");$(".mode-buttons .active").removeClass("active");$(".mode-buttons #mode-"+H).addClass("active");n(H);l.canvas.setMode(H)}function C(H){$(".mode-buttons .active").removeClass("active");$(".mode-buttons #mode-"+H).addClass("active")}function m(H){l.memory.fileImported(H)}function B(H){H.preventDefault();var I=$(H.target).attr("id").replace("history-","");l.canvas.historyUpdate(I)}function E(H){H.preventDefault();l.canvas.deleteSelected()}function A(H){H.preventDefault();var I="";I+='<div class="dialog dialog-remove-all">';I+="<p>Delete all Blocks?</p>";I+='<a href="#" id="dialog-confirm">OK</p>';I+='<a href="#" id="dialog-cancel">Cancel</p>';I+="</div>";$("body").append(I);$(".dialog-remove-all #dialog-confirm").click(q);$(".dialog-remove-all #dialog-cancel").click(t)}function q(H){H.preventDefault();l.canvas.clear();t()}function p(H){H.preventDefault();l.canvas.deleteTransparent()}function t(H){if(H){H.preventDefault()}$(".dialog").remove()}function a(H){H.preventDefault();n("export")}function o(H){H.preventDefault();n("import")}function i(H){H.preventDefault();n("save")}function s(H){H.preventDefault();n("load");j()}function f(H){H.preventDefault();l.memory.exportHTML(H)}function c(H){H.preventDefault();l.memory.exportJSON(H)}function D(H){H.preventDefault();if(!h){h=true;$(H.target).text("Saved").addClass("inactive");l.memory.save()}}function n(H){$(".info-container > *").not(".info-"+H).removeClass("info-container-active").hide();$(".info-container ."+H+"-info").addClass("info-container-active").show();$(".mode-buttons #mode-"+H).addClass("active").parent().siblings().find("a").removeClass("active")}function j(){var J=l.memory.load();var H="";if(J.length){if(!$(".load-info .sketch-list").length){$(".load-info").append('<ul class="sketch-list"></ul>')}for(var I=0;I<J.length;I++){H+='<li id="sketch-'+I+'">';H+='<p class="sketch-name"><a href="#">'+J[I].name+"</a></p>";H+='<p class="sketch-date">'+J[I].date+"</p>";H+="</li>"}$(".load-info .sketch-list").html(H);$(".load-info .sketch-list a").click(y)}else{}}function y(H){var J=$(H.target).closest("li").attr("id").replace("sketch-","");var I=l.memory.load();if(I&&I.length&&I[J]&&I[J].blocks){l.canvas.clear();l.canvas.importBlocks(I[J].blocks)}}function F(){setTimeout(function(){$(".save-info a").text("Save").removeClass("inactive");h=false},1500)}function b(H){l.canvas.previewRemove()}function G(H){l.canvas.previewUpdateBlocks()}function u(H){$(H).each(function(){$(this).append('<div class="nav-slider"></div>');$(this).find(".nav-slider").slider(r);$(this).find("h1").text($(this).text()+": "+r.value);var I=$(this).closest("li").attr("id").replace("size-","");l.canvas.sizeUpdate({id:I,value:r.value})})}function w(H,J){if($(H.target).closest("li").attr("id")){var I=$(H.target).closest("li").attr("id").replace("size-","");$(H.target).closest("li").find("h1").text(I+": "+J.value);l.canvas.sizeUpdate({id:I,value:J.value})}}function k(){var H=[];$(".color-buttons a").each(function(I,J){H.push($(J).attr("id").replace("color-button-",""))});return H}e.init=z;e.stop=v;e.start=g;e.savedToLocal=F;e.showInfo=n;e.setMode=C;e.getColors=k};function stringToSlug(c){c=c.replace(/^\s+|\s+$/g,"");c=c.toLowerCase();var e="àáäâèéëêìíïîòóöôùúüûñç·/_,:;";var d="aaaaeeeeiiiioooouuuunc------";for(var b=0,a=e.length;b<a;b++){c=c.replace(new RegExp(e.charAt(b),"g"),d.charAt(b))}c=c.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-");return c}function getRandomNumber(d,b,c){var a=Math.random()+(b-d)+d;if(c){a=Math.floor(Math.random()*(b-d+1))+d}return a}function getNumberKey(a){return[49,50,51,52,53,54,55,56,57,48].indexOf(a)}function getColors(){var a=[];$(".color-buttons a").each(function(){var b=$(this).attr("id").replace("color-button-","");a.push(b)});return a}function getBlockSize(){return{width:28,height:14}};